<!--
Licensed under the Apache License, Version 2.0 (the "License"); you may not
use this file except in compliance with the License. You may obtain a copy of
the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations under
the License.
-->

<form id="compaction" class="form-horizontal">
	<h2>Replicate changes from:</h2>

	<div class="row">
		<div class="from form_set">
			<div class="control-group from_local">
				<label for="from_local">
					<input type="radio" id="from_local" name="from_type" value="local" checked="" class="setType">
					Local database:
				</label>
				<select id="from_name" name="source">
					<% _.each( databases, function( db, i ){ %>
					   <option value="<%=db.name%>"><%=db.name%></option>
					<% }); %>
				</select>
			</div>

			<div class="control-group from_to_remote">
				<label for="from_to_remote">
					<input type="radio" id="from_to_remote" name="from_type" value="remote" class="setType">
					Remote database:
				</label>
				<input type="text" id="from_url" name="source" size="30" value="http://" disabled="true">
			</div>
		</div>

		<span class="swap">
		</span>

		<div class="to form_set">
			<div class="to_local control-group">
				<label for="to_local">
					<input type="radio" id="to_local" name="to_type" value="local" checked="" class="setType">
					Local database:
				</label>
				<select id="to_name" name="target">
					<% _.each( databases, function( db, i ){ %>
					   <option value="<%=db.name%>"><%=db.name%></option>
					<% }); %>
				</select>
			</div>

			<div class="to_remote control-group">
				<label for="to_remote">
					<input type="radio" id="to_remote" name="to_type" value="remote" class="setType">
					Remote database:
				</label>
				<input type="text" id="to_url" name="target" size="30" value="http://" disabled="true">
			</div>
		</div>
	</div>

	<span class="options off">Advanced Options</span>
	<div class="advancedOptions hidden">
		<h4>Apply filters</h4>
		<p>Sometimes you don't want to transfer all documents from source to target. You can include one or more filter functions in a design document on the source and then tell the replicator to use them.</p>
		<label for="filter">Enter the design doc and filter name</label>
		<input type="text" placeholder="myddoc/myfilter" name="filter" id="filter"/>
		<label for="query">Add query parameters (optional)</label>
		<input type="text" placeholder='{"key":"value"}' name="query_params" id="query"/>

		<hr>
		<h4>Named Document compaction</h4>
		<p>Sometimes you only want to replicate some documents. For this simple case you do not need to write a filter function. Simply add the list of keys, separated by commas.</p>
		<input type="text" placeholder="foo, bar, baz" name="doc_ids" id="doc_ids"/>

		<hr>
		<h4>Replicate through a proxy</h4>
		<p>Pass a "proxy" argument in the compaction data to have compaction go through an HTTP proxy</p>
		<input type="text" placeholder="http://localhost:8888" name="proxy" id="proxy"/>

	</div>

	<div class="actions">
		<div class="control-group">
			<label for="continuous">
				<input type="checkbox" name="continuous" value="continuous" id="continuous">
				Continuous
			</label>
		</div>

		<button class="btn btn-primary" type="submit">Replicate</button>
	</div>
</form>

<div id="compactionStatus"></div>
